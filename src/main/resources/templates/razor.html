<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Razorpay Checkout</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
<h1>Razorpay Checkout</h1>
<form th:action="@{/payment/checkout}" method="post">
    <input type="hidden" id="orderId" name="orderId" th:value="${orderId}" />
    <input type="submit" value="Proceed to Pay" />
</form>

<script>
        document.querySelector('form').addEventListener('submit', function (e) {
            e.preventDefault();

            var orderId = document.getElementById('orderId').value;

            fetch('/payment/confirm', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ orderId: orderId })
            })
            .then(function (response) {
                return response.json();
            })
            .then(function (response) {
                var options = {
                    key: 'response.key',
                    currency: 'INR',
                    amount: 100,
                    order_id: response.id,
                    name: 'GO-SHOP',
                    description: 'Test Payment',
                    handler: function (response) {
                        alert('Payment successful!');
                        // Handle payment success
                    },
                    prefill: {
                        name: 'John Doe',
                        email: 'john@example.com',
                        contact: '+1234567890'
                    }
                };

                var rzp1 = new Razorpay(options);
                rzp1.open();
            });
        });
    </script>
</body>
</html>